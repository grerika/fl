---
title: "Szakdolgozat (FL)"
author: "Statisztika (GE)"
date: "December, 2017"
output:
  pdf_document: default
  word_document: default
---

# Hipotézisek

\begin{enumerate}
\item  Hüvelyi szülés után a medencefenék izmai megnyúlnak a császármetszéshez képest.
\item  Az újszülött súlya szignifikáns összefüggést mutat a medencefenék izmainak megnyúlásával. A nagyobb születési súllyal megnõ a medencefenék izmainak megnyúlása.
\item  A szülések számával arányosan nõ a medencefenék izmainak megnyúlása.
\item  Az anyai BMI-vel arányosan nõ a medencefenék izmainak megnyúlása.
\item  A terhességi korral arányosan növekszig a medencefenék izmainak megnyúlása (mondjuk az elsõ trimeszterbeli értékeket kellene összevetni a szülés elõttivel).
\item  A szülés elõtti medencefenék (36. hetes UH) megnyúlása nagyobb a szülés utáni 6 hetes kontrollhoz képest.
\item	Fiatalabb várandósoknál kisebb mértékú az izmok megnyúlása, mint az idõsebbeknél
\item	Fiatal várandósoknál nagyobb a szülés elõtt és a szülés után mért izomnyúlás közötti különbség, mint az idõsebb várandósoknál. (jobb a regenerációs hajlam fiatalabb korban)
\item	Az izommegnyúlás mértéke korrelál a testmagassággal.
\item Szülés módja alapján a dL\_9-dL\_8 értékek nõnek hüvelyi szülés esetén
\end{enumerate}

,,Megnyúlnak'' = delták. Abszolút érték számít. TODO


## Magyarázat

\begin{tabular}{ll}
Mag	& Anyai magasság (cm)\\
Gr	& Terhességek száma\\
Pa	& Hüvelyi szülések száma\\
Cae	& Császármetszések száma\\
Sz\_mod	& Szülés módja: PVN=hüvelyi, SC=császár\\
Sz\_het	& Szüléskor betöltött terhességi hetek száma\\
Sz\_suly	& Újszülött tömege\\
Tkor\_\*	& Terhességi kor napban kifejezve *-dik méréskor\\
CRL\_\*	& Ülõméret *-dik méréskor\\
BPD\_\*	& Biparietalis distance *-dik megjelenéskor\\
L1\_\*; H1\_\*\dots &	Méretek nyugalomban (mm)\\
L2\_\*; H2\_\*\dots	&Méretek hasprésre (mm)\\
Ttkg\_\* & 	Anyai testtömeg \*-dik méréskor (kg)\\
dL\_\*; dH\_* &	L1\_\* - L2\_\*; H1\_\* - H2\_\*\dots\\
Suly\_\*&	Magzat becsült tömege *-dik megjelenéskor\\
\end{tabular}

```{r}
d = read.csv("~/Work/Education/Statisztikai_elemzesek/FarkasLajos_noi_klinika/STAT_DB.csv")
attach(d)
summary(d)
```

\clearpage

# 1. Hüvelyi szülés után a medencefenék izmai megnyúlnak a császármetszéshez képest.
TODO: abszolút érték vagy sem?

```{r}
csoport = Sz_mod
valt = dL_9
valt_PVN = valt[csoport=="PVN"]
valt_SC  = valt[csoport=="SC"]
```

## Leíró statisztikák
```{r}
table(csoport)
summary(valt_PVN)
summary(valt_SC)
sd(valt,na.rm=TRUE)
sd(valt_PVN,na.rm=T)
sd(valt_SC,na.rm=T)
```

## Grafikonok
```{r}
par(mfrow=c(2,2))
lim=c(min(min(valt_PVN,na.rm=T),min(valt_SC,na.rm=T)),max(max(valt_PVN,na.rm=T),max(valt_SC,na.rm=T)))
hist(valt_PVN,xlab="",ylab="",main="PVN",xlim=lim);hist(valt_SC,xlab="",ylab="",main="SC",xlim=lim)
boxplot(valt_PVN,horizontal=T,xlim=lim); boxplot(valt_SC,horizontal=T,xlim=lim)
par(mfrow=c(1,1))
```

## Egyoldalas páros t-próba
```{r}
t.test(valt~csoport,alternative = "greater")
```
\clearpage

# 2. Az újszülött súlya szignifikáns összefüggést mutat a medencefenék izmainak megnyúlásával. A nagyobb születési súllyal megnõ a medencefenék izmainak megnyúlása.

TODO túl alacsony HC_8 értékek?

```{r, fig.height=4, fig.width=5}
x = HC_8[HC_8>200]
y = dL_8[HC_8>200]
plot(x,y)
cor.test(x,y)
```

\clearpage

# 3. A szülések számával arányosan nõ a medencefenék izmainak megnyúlása.
```{r}
csoport = Pa + Cae; x = dL_9; table(csoport)
```

## Ábrák
```{r, echo=FALSE, fig.height=4, fig.width=6}
boxplot(x~csoport,horizontal=T,ylab="Szulesek szama",xlab="dL_9")
```

```{r, echo=FALSE}
par(mfrow=c(2,2))
hist(x[csoport==1],xlim=c(-6,12),xlab="1 szules (dL_9)",main="")
hist(x[csoport==2],xlim=c(-6,12),xlab="2 szules (dL_9)",main="")
hist(x[csoport==3],xlim=c(-6,12),xlab="3 szules (dL_9)",main="")
hist(x[csoport==4],xlim=c(-6,12),xlab="4 szules (dL_9)",main="")
par(mfrow=c(1,1))
```

## Egyszempontos ANOVA
```{r}
fit = aov(x~csoport)
summary(fit)
```

\clearpage

# 4. Az anyai BMI-vel arányosan nõ a medencefenék izmainak megnyúlása.
TODO adatok tisztítása! Van egy 44.5-ös BMI, az reális?

```{r}
x = dL_9
y = BMI
plot(x,y,xlab="dL_9",ylab="BMI")
cor.test(x,y)
```

\clearpage


# 9. Az izommegnyúlás mértéke korrelál a testmagassággal.
```{r}
x = dL_9
y = Mag
plot(x,y,xlab="dL_9",ylab="BMI")
cor.test(x,y)
```

\clearpage

# 5. A terhességi korral arányosan növekszig a medencefenék izmainak megnyúlása (mondjuk az elsõ trimeszterbeli értékeket kellene összevetni a szülés elõttivel).

```{r}
df = data.frame(c(Tkor_1,Tkor_2,Tkor_3,Tkor_4,Tkor_5,Tkor_6,Tkor_7,Tkor_8),c(dL_1,dL_2,dL_3,dL_4,dL_5,dL_6,dL_7,dL_8))
xTkor = df$c.Tkor_1..Tkor_2..Tkor_3..Tkor_4..Tkor_5..Tkor_6..Tkor_7..Tkor_8.
yDL = df$c.dL_1..dL_2..dL_3..dL_4..dL_5..dL_6..dL_7..dL_8.
summary(yDL)
time = 1:8
yATLAG = c(mean(dL_1,na.rm=T),mean(dL_2,na.rm=T),mean(dL_3,na.rm=T),mean(dL_4,na.rm=T),mean(dL_5,na.rm=T),mean(dL_6,na.rm=T),mean(dL_7,na.rm=T),mean(dL_8,na.rm=T))
dL1 = t.test(dL_1); dL1_conf=c(dL1$conf.int[1],dL1$conf.int[2])
dL = t.test(dL_2); dL2_conf=c(dL$conf.int[1],dL$conf.int[2])
dL = t.test(dL_3); dL3_conf=c(dL$conf.int[1],dL$conf.int[2])
dL = t.test(dL_4); dL4_conf=c(dL$conf.int[1],dL$conf.int[2])
dL = t.test(dL_5); dL5_conf=c(dL$conf.int[1],dL$conf.int[2])
dL = t.test(dL_6); dL6_conf=c(dL$conf.int[1],dL$conf.int[2])
dL = t.test(dL_7); dL7_conf=c(dL$conf.int[1],dL$conf.int[2])
dL = t.test(dL_8); dL8_conf=c(dL$conf.int[1],dL$conf.int[2])
yConfLower = c(dL1_conf[1],dL2_conf[1],dL3_conf[1],dL4_conf[1],dL5_conf[1],dL6_conf[1],dL7_conf[1],dL8_conf[1])
yConfUpper = c(dL1_conf[2],dL2_conf[2],dL3_conf[2],dL4_conf[2],dL5_conf[2],dL6_conf[2],dL7_conf[2],dL8_conf[2])
yl=c(min(yConfLower),max(yConfUpper))
xl = c(0,9)
#plot(time,yATLAG,xlab="kontroll",ylab="Atlagos DL ertek az x. kontrollnal",xlim=xl,ylim=yl)
plot(c(time,time,time),c(yConfLower,yATLAG,yConfUpper),xlab="kontroll",ylab="Átlagos DL ertek (95% CI) az x. kontrollnal",xlim=xl,ylim=yl)
#par(new = TRUE);plot(time,yConfLower,col="blue",xlim=xl,ylim=yl, xlab='', ylab='', axes=F);par(new = FALSE)
#plot(x,y,xlab="Tkor",ylab="dL")
#cor.test(x,y)
```
\clearpage

# 6. A szülés elõtti medencefenék (36. hetes UH) megnyúlása nagyobb a szülés utáni 6 hetes kontrollhoz képest.
```{r}
kontroll_6hetes = dL_9
szules_elott = dL_8
kul = szules_elott - kontroll_6hetes
```

## Ábrák
```{r, echo=FALSE}
par(mfrow=c(1,3))
hist(dL_8,xlab="dL_8",main="")
hist(dL_9,xlab="dL_9",main="")
hist(kul,xlab="dL_9-dL_8",main="")
par(mfrow=c(1,1))
boxplot(kontroll_6hetes,szules_elott,kul,horizontal=TRUE,names=c("dL_9","dL_8","kulonbseg"))
```

## Páros t-próba
```{r}
t.test(kontroll_6hetes,szules_elott,alternative="greater",paired=TRUE)
```

\clearpage

# 7-8. Fiatalabb várandósoknál kisebb mértékû az izmok megnyúlása, mint az idõsebbeknél. 	Fiatal várandósoknál nagyobb a szülés elõtt és a szülés után mért izomnyúlás közötti különbség, mint az idõsebb várandósoknál. (jobb a regenerációs hajlam fiatalabb korban)
```{r}
x = Ék
y1 = dL_8
y2 = dL_9
yd = y2-y1
```

## Ábrák
```{r, echo=FALSE}
par(mfrow=c(1,3))
plot(x,y1,xlab="életkor",ylab="dL_8")
plot(x,y2,xlab="életkor",ylab="dL_9")
plot(x,yd,xlab="életkor",ylab="dL_9-dL_8")
par(mfrow=c(1,1))
```

\clearpage

## Korreláció vizsgálatok
```{r}
cor.test(x,y1)
cor.test(x,y2)
cor.test(x,yd)
```
\clearpage

# 10. Szülés módja alapján a dL\_9-dL\_8 értékek nõnek hüvelyi szülés esetén

## Leíró statisztikák
```{r}
csoport = Sz_mod
valt = dL_9-dL_8
valt_PVN = valt[csoport=="PVN"]
valt_SC = valt[csoport=="SC"]
summary(valt);summary(valt_PVN);summary(valt_SC)
sd(valt,na.rm=TRUE);sd(valt_PVN,na.rm=TRUE);sd(valt_SC,na.rm=TRUE)
```

## Ábrák
```{r echo=FALSE}
boxplot(valt_PVN,valt_SC,horizontal=T,names=c("PVN","SC"),xlab="dL9-dL8")
```

## Kétmintás t-próba
```{r}
t.test(valt_PVN,valt_SC,alternative="greater")
```
